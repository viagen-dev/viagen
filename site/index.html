<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="Viagen is a Vite dev server plugin that embeds Claude Code into your app. Chat with Claude to build, edit, and fix your app in real time."
        />
        <title>viagen — Claude in your dev server on a sandbox</title>
        <link rel="icon" type="image/svg+xml" href="/icon.svg" />
        <style>
            :root {
                --bg: #09090b;
                --bg-secondary: #18181b;
                --border: #27272a;
                --border-hover: #3f3f46;
                --text: #e4e4e7;
                --text-muted: #a1a1aa;
                --text-dim: #71717a;
                --code-text: #d4d4d8;
            }
            [data-theme="light"] {
                --bg: #ffffff;
                --bg-secondary: #f4f4f5;
                --border: #e4e4e7;
                --border-hover: #d4d4d8;
                --text: #18181b;
                --text-muted: #52525b;
                --text-dim: #71717a;
                --code-text: #3f3f46;
            }
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                font-family:
                    system-ui,
                    -apple-system,
                    sans-serif;
                background: var(--bg);
                color: var(--text);
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                align-items: center;
                transition:
                    background-color 0.2s,
                    color 0.2s;
            }
            a {
                color: var(--text-muted);
                text-decoration: none;
                transition: color 0.15s;
            }
            a:hover {
                color: var(--text);
            }
            .container {
                max-width: 640px;
                width: 100%;
                padding: 80px 24px 48px;
                position: relative;
            }
            h1 {
                font-family: ui-monospace, monospace;
                font-size: 32px;
                font-weight: 700;
                letter-spacing: -0.02em;
                margin-bottom: 4px;
            }
            .etymology {
                font-family: ui-monospace, monospace;
                font-size: 13px;
                color: var(--text-dim);
                margin-bottom: 16px;
                font-style: italic;
            }
            .etymology span {
                font-style: normal;
                color: var(--text-muted);
            }
            .tagline {
                font-size: 18px;
                color: var(--text-muted);
                line-height: 1.6;
                margin-bottom: 40px;
            }
            .theme-toggle {
                position: absolute;
                top: 36px;
                right: 41px;
                background: none;
                border: none;
                cursor: pointer;
                padding: 4px;
                color: var(--text-muted);
                transition: color 0.15s;
                display: flex;
                align-items: center;
            }
            .theme-toggle:hover {
                color: var(--text);
            }
            .theme-toggle svg {
                width: 20px;
                height: 20px;
            }
            .install {
                background: var(--bg-secondary);
                border: 1px solid var(--border);
                border-radius: 8px;
                padding: 16px 20px;
                margin-bottom: 40px;
                display: flex;
                align-items: flex-start;
                justify-content: space-between;
            }
            .install code {
                font-family: ui-monospace, monospace;
                font-size: 14px;
                color: var(--code-text);
                white-space: pre;
                line-height: 1.7;
            }
            .install button {
                background: none;
                border: 1px solid var(--border-hover);
                color: var(--text-dim);
                border-radius: 5px;
                padding: 4px 10px;
                font-size: 11px;
                cursor: pointer;
                font-family: inherit;
                transition:
                    border-color 0.15s,
                    color 0.15s;
            }
            .install button:hover {
                border-color: var(--text-dim);
                color: var(--text);
            }
            section {
                margin-bottom: 36px;
            }
            h2 {
                font-size: 14px;
                font-weight: 600;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                color: var(--text-dim);
                margin-bottom: 12px;
            }
            pre {
                background: var(--bg-secondary);
                border: 1px solid var(--border);
                border-radius: 8px;
                padding: 16px 20px;
                overflow-x: auto;
            }
            pre code {
                font-family: ui-monospace, monospace;
                font-size: 13px;
                line-height: 1.7;
                color: var(--text-muted);
            }
            .codeblock {
                position: relative;
            }
            .codeblock pre code {
                font-size: 14px;
                color: var(--code-text);
            }
            .codeblock button {
                position: absolute;
                top: 16px;
                right: 16px;
                background: none;
                border: 1px solid var(--border-hover);
                color: var(--text-dim);
                border-radius: 5px;
                padding: 4px 10px;
                font-size: 11px;
                cursor: pointer;
                font-family: inherit;
                transition:
                    border-color 0.15s,
                    color 0.15s;
            }
            .codeblock button:hover {
                border-color: var(--text-dim);
                color: var(--text);
            }
            .features {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
            .feature {
                background: var(--bg-secondary);
                border: 1px solid var(--border);
                border-radius: 8px;
                padding: 16px;
            }
            .feature h3 {
                font-size: 13px;
                font-weight: 600;
                margin-bottom: 4px;
                color: var(--code-text);
            }
            .feature p {
                font-size: 12px;
                color: var(--text-dim);
                line-height: 1.5;
            }
            .prereqs {
                list-style: none;
                padding: 0;
            }
            .prereqs li {
                font-size: 14px;
                color: var(--text-muted);
                line-height: 1.6;
                padding: 8px 0;
                border-bottom: 1px solid var(--border);
            }
            .prereqs li:last-child {
                border-bottom: none;
            }
            .prereqs a {
                color: var(--text);
                font-weight: 500;
                text-decoration: underline;
                text-underline-offset: 2px;
                text-decoration-color: var(--border-hover);
            }
            .prereqs a:hover {
                text-decoration-color: var(--text-dim);
            }
            .links {
                display: flex;
                gap: 20px;
                margin-top: 48px;
                padding-top: 24px;
                border-top: 1px solid var(--border);
                font-size: 13px;
            }
            .footer {
                margin-top: 24px;
                padding-top: 16px;
                font-size: 12px;
                color: var(--text-dim);
                text-align: center;
            }
            .footer a {
                color: var(--text-dim);
            }
            .footer a:hover {
                color: var(--text-muted);
            }
            @media (max-width: 480px) {
                .features {
                    grid-template-columns: 1fr;
                }
                .container {
                    padding: 48px 16px 32px;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <button
                class="theme-toggle"
                id="themeToggle"
                aria-label="Toggle theme"
            >
                <svg
                    id="themeIcon"
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <circle cx="12" cy="12" r="4"></circle>
                    <path d="M12 2v2"></path>
                    <path d="M12 20v2"></path>
                    <path d="m4.93 4.93 1.41 1.41"></path>
                    <path d="m17.66 17.66 1.41 1.41"></path>
                    <path d="M2 12h2"></path>
                    <path d="M20 12h2"></path>
                    <path d="m6.34 17.66-1.41 1.41"></path>
                    <path d="m19.07 4.93-1.41 1.41"></path>
                </svg>
            </button>
            <h1>viagen</h1>
            <p class="etymology">
                /ˈviː.ə.dʒən/ <span>n.</span> vite + agent; also: travel
                <span>(Portuguese)</span>
            </p>
            <p class="tagline">
                A dev server plugin and cli tool that enables you to use Claude
                Code in a sandbox — instantly.
            </p>

            <section>
                <h2>Prerequisites</h2>
                <ul class="prereqs">
                    <li>
                        <a href="https://claude.ai/signup">Claude</a> — Max,
                        Pro, or API plan. The setup wizard handles auth.
                    </li>
                    <li>
                        <a href="https://vercel.com/signup">Vercel</a> — Free
                        plan works. Sandboxes last 45 min on Hobby, 5 hours on
                        Pro.
                    </li>
                    <li>
                        <a href="https://cli.github.com">GitHub CLI</a> —
                        Enables git clone and push from sandboxes.
                    </li>
                </ul>
            </section>

            <section>
                <h2>Step 1 — Add viagen to your app</h2>
                <div class="install">
                    <code>npm install --save-dev viagen</code>
                    <button
                        onclick="navigator.clipboard.writeText('npm install --save-dev viagen').then(()=>{this.textContent='Copied!';setTimeout(()=>this.textContent='Copy',1500)})"
                    >
                        Copy
                    </button>
                </div>
                <div class="codeblock">
                    <button
                        onclick="navigator.clipboard.writeText(`import { defineConfig } from 'vite'\nimport { viagen } from 'viagen'\n\nexport default defineConfig({\n  plugins: [viagen()],\n})`).then(()=>{this.textContent='Copied!';setTimeout(()=>this.textContent='Copy',1500)})"
                    >
                        Copy
                    </button>
                    <!-- prettier-ignore -->
                    <pre><code>// vite.config.ts
import { defineConfig } from 'vite'
import { viagen } from 'viagen'

export default defineConfig({
  plugins: [viagen()],
})</code></pre>
                </div>
            </section>

            <section>
                <h2>Step 2 — Setup</h2>
                <div class="install">
                    <code>npx viagen setup</code>
                    <button
                        onclick="navigator.clipboard.writeText('npx viagen setup').then(()=>{this.textContent='Copied!';setTimeout(()=>this.textContent='Copy',1500)})"
                    >
                        Copy
                    </button>
                </div>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                    "
                >
                    The setup wizard authenticates with Claude then uses github
                    and vercel to write your local
                    <code style="font-size: 12px; color: var(--code-text)"
                        >.env</code
                    >.
                </p>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                        margin-top: 10px;
                    "
                >
                    You can now run
                    <code style="font-size: 12px; color: var(--code-text)"
                        >npm run dev</code
                    >
                    to start the local dev server. At this point you can launch
                    viagen and chat with Claude to make changes do your app.
                </p>
            </section>

            <section>
                <h2>Step 3 — Sandbox</h2>
                <div class="install">
                    <code>npx viagen sandbox</code>
                    <button
                        onclick="navigator.clipboard.writeText('npx viagen sandbox').then(()=>{this.textContent='Copied!';setTimeout(()=>this.textContent='Copy',1500)})"
                    >
                        Copy
                    </button>
                </div>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                    "
                >
                    Deploys your dev server to a remote Vercel Sandbox — an
                    isolated vm-like environment where Claude can read, write,
                    and push code.
                </p>
                <pre
                    style="margin-top: 16px"
                ><code># Deploy on a specific branch
npx viagen sandbox --branch feature/my-thing

# Set a longer timeout (default: 30 min)
npx viagen sandbox --timeout 60

# Stop a running sandbox
npx viagen sandbox stop &lt;sandboxId&gt;</code></pre>
            </section>

            <section>
                <h2>SSR Frameworks</h2>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                    "
                >
                    For plain Vite apps, the chat panel is injected
                    automatically. SSR frameworks (React Router, Remix,
                    SvelteKit, etc.) render their own HTML, so add one script
                    tag to your root layout:
                </p>
                <pre
                    style="margin-top: 12px"
                ><code>&lt;script src="/via/client.js" defer&gt;&lt;/script&gt;</code></pre>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                        margin-top: 12px;
                    "
                >
                    For React Router, add it to
                    <code style="font-size: 12px; color: var(--code-text)"
                        >app/root.tsx</code
                    >
                    inside the
                    <code style="font-size: 12px; color: var(--code-text)"
                        >&lt;head&gt;</code
                    >.
                </p>
            </section>

            <section>
                <h2>Vite Plugin Options</h2>
                <pre><code>viagen({
  position: 'bottom-right',  // toggle button position
  model: 'sonnet',           // claude model
  panelWidth: 420,           // chat panel width in px
  overlay: true,             // fix button on error overlay
  ui: true,                  // inject chat panel into pages
  sandboxFiles: [...],       // copy files manually into sandbox
  editable: ['src'],         // files/dirs editable in the UI
  systemPrompt: '...',       // custom system prompt (see below)
})</code></pre>

                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                        margin-top: 16px;
                    "
                >
                    The default system prompt:
                </p>
                <pre
                    style="margin-top: 12px"
                ><code>You are embedded in a Vite dev server as the "viagen" plugin.
Your job is to help build and modify the app. Files you edit
will trigger Vite HMR automatically. You can read
.viagen/server.log to check recent Vite dev server output
(compile errors, HMR updates, warnings). When running in a
sandbox with git, the gh CLI is available and authenticated —
you can create pull requests, comment on issues, and manage
releases.

Publishing workflow:
- On a feature branch: commit, push, and create a pull
  request using "gh pr create". Share the PR URL.
- On main/master with Vercel credentials: commit, push,
  and run "vercel deploy" to publish a preview.
- Check your branch with "git branch --show-current" first.

Be concise.</code></pre>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                        margin-top: 16px;
                    "
                >
                    Recent build errors are automatically appended to give
                    Claude context about what went wrong. To customize the
                    prompt, you can replace it entirely or extend the default:
                </p>
                <pre
                    style="margin-top: 12px"
                ><code>import { viagen, DEFAULT_SYSTEM_PROMPT } from 'viagen'

viagen({
  // Replace entirely
  systemPrompt: 'You are a React expert. Only use TypeScript.',

  // Or extend the default
  systemPrompt: `${DEFAULT_SYSTEM_PROMPT}
Always use Tailwind for styling.`,
})</code></pre>
            </section>

            <section>
                <h2>API</h2>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                    "
                >
                    Every viagen endpoint is available as an API. Build your own
                    UI, integrate with CI, or script Claude from the command
                    line.
                </p>
                <pre
                    style="margin-top: 16px"
                ><code>POST /via/chat        — send a message, streamed SSE response
POST /via/chat/reset  — clear conversation history
GET  /via/health      — check API key status
GET  /via/error       — latest build error (if any)
GET  /via/ui          — standalone chat interface
GET  /via/iframe      — split view (app + chat side by side)
GET  /via/files       — list editable files (when configured)
GET  /via/file?path=  — read file content
POST /via/file        — write file content { path, content }</code></pre>
                <p
                    style="
                        font-size: 15px;
                        color: var(--text-muted);
                        line-height: 1.8;
                        margin-top: 16px;
                    "
                >
                    When
                    <code style="font-size: 12px; color: var(--code-text)"
                        >VIAGEN_AUTH_TOKEN</code
                    >
                    is set (always on in sandboxes), pass the token as a
                    <code style="font-size: 12px; color: var(--code-text)"
                        >Bearer</code
                    >
                    header or
                    <code style="font-size: 12px; color: var(--code-text)"
                        >?token=</code
                    >
                    query param.
                </p>
                <pre style="margin-top: 16px"><code># With curl
curl -X POST http://localhost:5173/via/chat \
  -H "Authorization: Bearer $VIAGEN_AUTH_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"message": "add a hello world route"}'

# Or pass the token as a query param (sets a session cookie)
open "http://localhost:5173/via/ui?token=$VIAGEN_AUTH_TOKEN"</code></pre>
            </section>

            <div class="links">
                <a href="https://github.com/cif/viagen">GitHub</a>
                <a href="https://www.npmjs.com/package/viagen">npm</a>
                <a href="https://github.com/cif/viagen/blob/main/LICENSE"
                    >MIT License</a
                >
                <a href="/privacy.html">Privacy Policy</a>
            </div>
        </div>
        <script>
            const themeToggle = document.getElementById("themeToggle");
            const themeIcon = document.getElementById("themeIcon");
            const html = document.documentElement;

            const sunIcon = `<circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path>`;
            const moonIcon = `<path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>`;

            function getSystemTheme() {
                return window.matchMedia("(prefers-color-scheme: light)")
                    .matches
                    ? "light"
                    : "dark";
            }

            function setTheme(theme) {
                if (theme === "light") {
                    html.setAttribute("data-theme", "light");
                    themeIcon.innerHTML = moonIcon;
                } else {
                    html.removeAttribute("data-theme");
                    themeIcon.innerHTML = sunIcon;
                }
                sessionStorage.setItem("theme", theme);
            }

            const savedTheme = sessionStorage.getItem("theme");
            const initialTheme = savedTheme || getSystemTheme();
            setTheme(initialTheme);

            themeToggle.addEventListener("click", () => {
                const currentTheme =
                    html.getAttribute("data-theme") === "light"
                        ? "light"
                        : "dark";
                const newTheme = currentTheme === "light" ? "dark" : "light";
                setTheme(newTheme);
            });
        </script>
    </body>
</html>
